{"version":3,"file":"src_app_features_reservations_reservations-form_reservations-form_module_ts.js","mappings":"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","sources":["./src/app/features/reservations/reservations-form/reservations-form-routing.module.ts","./src/app/features/reservations/reservations-form/reservations-form.component.ts","./src/app/features/reservations/reservations-form/reservations-form.component.html","./src/app/features/reservations/reservations-form/reservations-form.module.ts","./src/app/shared/services/bus.service.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { ReservationsFormComponent } from './reservations-form.component';\r\n\r\nconst routes: Routes = [{ path: '', component: ReservationsFormComponent }];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class ReservationsFormRoutingModule { }\r\n","import { CommonModule } from \"@angular/common\";\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  OnDestroy,\n  OnInit,\n} from \"@angular/core\";\nimport { ActivatedRoute, Router, RouterModule } from \"@angular/router\";\nimport {\n  FormArray,\n  FormBuilder,\n  FormGroup,\n  FormsModule,\n  Validators,\n  ReactiveFormsModule,\n} from \"@angular/forms\";\nimport { BusService } from \"src/app/shared/services/bus.service\";\nimport { Bus } from \"src/app/shared/models/bus.model\";\nimport { Observable, Subject, takeUntil } from \"rxjs\";\nimport { ReservationService } from \"src/app/shared/services/reservation.service\";\nimport { Reservation } from \"src/app/shared/models/reservation.model\";\nimport { SnackbarService } from \"src/app/shared/components/snackbar/snackbar.service\";\n\n@Component({\n  selector: \"app-reservations-form\",\n  standalone: true,\n  imports: [CommonModule, RouterModule, FormsModule, ReactiveFormsModule],\n  templateUrl: \"./reservations-form.component.html\",\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ReservationsFormComponent implements OnInit, OnDestroy {\n  reservationForm!: FormGroup;\n  buses!: Observable<Bus[]>;\n  reservationToEdit!: Reservation;\n  editing = false;\n  reservationId!: number;\n  destroy$: Subject<void> = new Subject();\n\n  constructor(\n    private fb: FormBuilder,\n    private busService: BusService,\n    private reservationService: ReservationService,\n    private snackbarService: SnackbarService,\n    private router: Router,\n    private route: ActivatedRoute,\n    private cdRef: ChangeDetectorRef\n  ) {}\n\n  ngOnInit() {\n    this.initForm();\n    this.getBuses();\n    this.route.queryParams.subscribe(\n      (params) => (this.reservationId = params[\"reservationId\"])\n    );\n    if (this.reservationId) {\n      this.editing = true;\n      this.loadReservation();\n    }\n  }\n\n  getBuses() {\n    this.buses = this.busService.getAllBuses();\n  }\n\n  loadReservation() {\n    this.reservationService\n      .getReservationById(this.reservationId)\n      .pipe(takeUntil(this.destroy$))\n      .subscribe({\n        next: (reservation: Reservation) => {\n          this.reservationToEdit = reservation;\n          this.reservationForm.patchValue(this.reservationToEdit);\n          const trajetsArray = this.reservationForm.get(\"trajets\") as FormArray;\n\n          while (trajetsArray.length !== 0) {\n            trajetsArray.removeAt(0);\n          }\n\n          this.reservationToEdit.trajets?.forEach((trajet) => {\n            const trajetGroup = this.fb.group({\n              id: trajet.id,\n              nbrPlaces: trajet.nbrPlaces,\n              departureTime: trajet.departureTime,\n              bus: this.fb.group({\n                id: trajet.bus.id,\n                busNumber: trajet.bus.busNumber,\n                unitTrajetPrice: trajet.bus.unitTrajetPrice,\n              }),\n            });\n\n            trajetsArray.push(trajetGroup);\n          });\n          trajetsArray.markAsDirty();\n          this.cdRef.detectChanges();\n        },\n        error: (error) =>\n          console.log(\n            \"Error while getting reservation with id\" + this.reservationId,\n            error\n          ),\n      });\n  }\n\n  initForm() {\n    this.reservationForm = this.fb.group({\n      id: [''],\n      reservationDate: [''],\n      client: this.fb.group({\n        id: [1],\n        name: [{ value: \"userTest\", disabled: true }, Validators.required],\n        email: [\n          { value: \"test@gmail.com\", disabled: true },\n          [Validators.required, Validators.email],\n        ],\n      }),\n      trajets: this.fb.array([]),\n    });\n  }\n\n  get trajets() {\n    return this.reservationForm.get(\"trajets\") as FormArray;\n  }\n\n  addTrajet() {\n    this.trajets.push(\n      this.fb.group({\n        nbrPlaces: [0, Validators.required],\n        departureTime: [\"\", Validators.required],\n        unitTrajetPrice: [\"\"],\n        bus: this.fb.group({\n          busNumber: [null, Validators.required],\n          unitTrajetPrice: [0.0, Validators.required],\n        }),\n      })\n    );\n  }\n\n  deleteTrajet(index: number) {\n    this.trajets.removeAt(index);\n  }\n\n  submit() {\n    const reservation: Reservation = {\n      ...this.reservationForm?.value,\n    };\n\n    console.log(\"reservation to save:\", this.reservationForm.value);\n    if (this.reservationForm.value.trajets.length > 0 && this.reservationForm.valid) {\n      if (this.editing) {\n        this.updateReservation(reservation);\n      } else {\n          this.createReservation(reservation);\n      }\n    } else {\n      this.snackbarService.showError();\n    }\n  }\n\n  private createReservation(reservation: Reservation) {\n    this.reservationService\n      .createReservation(reservation)\n      .pipe(takeUntil(this.destroy$))\n      .subscribe({\n        next: () => {\n          this.snackbarService.showSuccess();\n          this.router.navigateByUrl(\"reservations\");\n        },\n      });\n  }\n\n  private updateReservation(reservation: Reservation) {\n    this.reservationService\n    .updateReservation(this.reservationId, reservation)\n    .pipe(takeUntil(this.destroy$))\n    .subscribe({\n        next: () => {\n            this.snackbarService.showSuccess();\n            this.router.navigateByUrl(\"reservations\");\n        },\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n}\n","<div class=\"container mt-4\">\n    <h2 *ngIf=\"editing\" class=\"mb-5\">Modification de la réservation N°: {{reservationId}}</h2>\n    <h2 *ngIf=\"!editing\" class=\"mb-5\">Création d'une nouvelle réservation</h2>\n    <form [formGroup]=\"reservationForm\" (ngSubmit)=\"submit()\">\n        <div formGroupName=\"client\" class=\"row\">\n            <div class=\"form-group col-3\">\n                <label for=\"client-name\">Name</label>\n                <input id=\"client-name\" formControlName=\"name\" class=\"form-control\">\n            </div>\n            <div class=\"form-group col-3\">\n                <label for=\"client-email\">Email</label>\n                <input id=\"client-email\" formControlName=\"email\" type=\"email\" class=\"form-control\">\n            </div>\n        </div>\n        <div formArrayName=\"trajets\">\n            <div class=\"mt-3\" *ngFor=\"let trajet of trajets.controls; index as i\">\n                <div [formGroupName]=\"i\" class=\"row\">\n                    <div formGroupName=\"bus\" class=\"col\">\n                        <label for=\"busNumber\">Bus:</label>\n                        <select id=\"busNumber\" formControlName=\"busNumber\" class=\"form-control\">\n                            <option *ngFor=\"let bus of buses | async as buses\" [value]=\"bus.busNumber\">{{bus.busNumber}}</option>\n                        </select>\n                    </div>\n                    <div class=\"col\">\n                        <label for=\"nbrPlaces\">Nbr Places:</label>\n                        <input id=\"nbrPlaces\" formControlName=\"nbrPlaces\" class=\"form-control\">\n                    </div>\n                    <div class=\"col\">\n                        <label for=\"departureTime\">Date de départ:</label>\n                        <input id=\"departureTime\" formControlName=\"departureTime\" type=\"datetime-local\" class=\"form-control\">\n                    </div>\n                    <div class=\"col mt-4\">\n                        <button type=\"button\" (click)=\"deleteTrajet(i)\" class=\"btn btn-danger btn-sm\">\n                            Supprimer\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <button type=\"button\" (click)=\"addTrajet()\" class=\"btn btn-primary mt-3\">\n                Ajouter un trajet\n            </button>\n        </div>\n        <button type=\"submit\" class=\"btn btn-success mt-3\" [disabled]=\"!trajets.controls.length\">\n            Sauvegarder sans payer\n        </button>\n    </form>\n</div>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ReservationsFormRoutingModule } from './reservations-form-routing.module';\r\nimport { ReservationsFormComponent } from './reservations-form.component';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    ReservationsFormRoutingModule,\r\n    ReservationsFormComponent,\r\n  ],\r\n  exports: [ReservationsFormComponent]\r\n})\r\nexport class ReservationsFormModule { }\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { Bus } from '../models/bus.model';\r\nimport { environment } from '../../../environments/environment';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class BusService {\r\n\r\n  private apiUrl = environment.apiUrl; \r\n\r\n  constructor(private http: HttpClient) { }\r\n\r\n  getAllBuses(): Observable<Bus[]> {\r\n    return this.http.get<Bus[]>(`${this.apiUrl}/buses`);\r\n  }\r\n}"],"names":["RouterModule","ReservationsFormComponent","routes","path","component","ReservationsFormRoutingModule","_","_2","_3","forChild","imports","i1","exports","CommonModule","FormsModule","Validators","ReactiveFormsModule","Subject","takeUntil","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","ctx_r0","reservationId","ɵɵproperty","bus_r6","busNumber","ɵɵtextInterpolate","ɵɵtemplate","ReservationsFormComponent_div_14_option_6_Template","ɵɵelement","ɵɵlistener","ReservationsFormComponent_div_14_Template_button_click_17_listener","restoredCtx","ɵɵrestoreView","_r9","i_r4","index","ctx_r8","ɵɵnextContext","ɵɵresetView","deleteTrajet","ɵɵpipeBind1","ctx_r2","buses","constructor","fb","busService","reservationService","snackbarService","router","route","cdRef","editing","destroy$","ngOnInit","initForm","getBuses","queryParams","subscribe","params","loadReservation","getAllBuses","getReservationById","pipe","next","reservation","reservationToEdit","reservationForm","patchValue","trajetsArray","get","length","removeAt","trajets","forEach","trajet","trajetGroup","group","id","nbrPlaces","departureTime","bus","unitTrajetPrice","push","markAsDirty","detectChanges","error","console","log","reservationDate","client","name","value","disabled","required","email","array","addTrajet","submit","valid","updateReservation","createReservation","showError","showSuccess","navigateByUrl","ngOnDestroy","complete","ɵɵdirectiveInject","FormBuilder","i2","BusService","i3","ReservationService","i4","SnackbarService","i5","Router","ActivatedRoute","ChangeDetectorRef","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","ReservationsFormComponent_Template","rf","ctx","ReservationsFormComponent_h2_1_Template","ReservationsFormComponent_h2_2_Template","ReservationsFormComponent_Template_form_ngSubmit_3_listener","ReservationsFormComponent_div_14_Template","ReservationsFormComponent_Template_button_click_15_listener","controls","i6","NgForOf","NgIf","AsyncPipe","ɵNgNoValidate","NgSelectOption","ɵNgSelectMultipleOption","DefaultValueAccessor","SelectControlValueAccessor","NgControlStatus","NgControlStatusGroup","FormGroupDirective","FormControlName","FormGroupName","FormArrayName","encapsulation","changeDetection","ReservationsFormModule","environment","http","apiUrl","ɵɵinject","HttpClient","factory","ɵfac","providedIn"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}